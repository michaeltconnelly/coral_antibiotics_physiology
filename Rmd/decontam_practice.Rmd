---
title: "decontam_practice"
author: "Mike Connelly"
date: "3/10/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# decontam intro vignette
# https://benjjneb.github.io/decontam/vignettes/decontam_intro.html
```

```{r}
head(sample_data(ps))
```

```{r}
df <- as.data.frame(sample_data(ps)) # Put sample_data into a ggplot-friendly data.frame
df$LibrarySize <- sample_sums(ps)
df <- df[order(df$LibrarySize),]
df$Index <- seq(nrow(df))
ggplot(data=df, aes(x=Index, y=LibrarySize, color = Neg_Control)) + geom_point()
```
## Frequency approach

## Prevalence approach
```{r}
contam_df_prev <- isContaminant(ps, method="prevalence", neg="Neg_Control", threshold = 0.5)
table(contam_df_prev$contaminant)
```
```{r}
which(contam_df_prev$contaminant)
```
```{r remove_contaminants}
ps.noncontam <- prune_taxa(!contam_df_prev$contaminant, ps)
ps.noncontam
```

